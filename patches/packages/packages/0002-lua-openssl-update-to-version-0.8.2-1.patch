From e954d9a8d2bec3911b24d58c17306e5fd59cfc96 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Maciej=20Kr=C3=BCger?= <mkg20001@gmail.com>
Date: Wed, 25 May 2022 16:56:59 +0200
Subject: [PATCH] lua-openssl: update to version 0.8.2-1

---
 lang/lua-openssl/Makefile                     |  2 +-
 lang/lua-openssl/patches/010-cmake.patch      | 66 -------------------
 ...20-no-luajit.patch => 010-no-luajit.patch} |  0
 3 files changed, 1 insertion(+), 67 deletions(-)
 delete mode 100644 lang/lua-openssl/patches/010-cmake.patch
 rename lang/lua-openssl/patches/{020-no-luajit.patch => 010-no-luajit.patch} (100%)

diff --git a/lang/lua-openssl/Makefile b/lang/lua-openssl/Makefile
index 6c2e10258..96d71ece0 100644
--- a/lang/lua-openssl/Makefile
+++ b/lang/lua-openssl/Makefile
@@ -12,7 +12,7 @@ PKG_RELEASE:=$(AUTORELEASE)
 
 PKG_SOURCE_PROTO:=git
 PKG_SOURCE_URL:=https://github.com/zhaozg/lua-openssl.git
-PKG_SOURCE_VERSION:=0.8.0-6
+PKG_SOURCE_VERSION:=0.8.2-1
 PKG_MIRROR_HASH:=d3b80bcde0463b3106cb8cdd1b255fa894ac5af02640c9f3c98ae706d3659267
 
 PKG_MAINTAINER:=Amnon Paz <pazamnon@gmail.com>
diff --git a/lang/lua-openssl/patches/010-cmake.patch b/lang/lua-openssl/patches/010-cmake.patch
deleted file mode 100644
index f9ff532b2..000000000
--- a/lang/lua-openssl/patches/010-cmake.patch
+++ /dev/null
@@ -1,66 +0,0 @@
-From a88d7f4348e54abba47a96f9ec4ffe7c60ba9400 Mon Sep 17 00:00:00 2001
-From: O <codetypes@gmail.com>
-Date: Fri, 30 Jul 2021 17:17:45 +0800
-Subject: [PATCH] build so file on mac
-
----
- CMakeLists.txt | 18 +++++++++++++-----
- 1 file changed, 13 insertions(+), 5 deletions(-)
-
---- a/CMakeLists.txt
-+++ b/CMakeLists.txt
-@@ -20,7 +20,7 @@ find_package(Threads REQUIRED)
- add_definitions(-DPTHREADS)
- 
- if(BUILD_SHARED_LUA_OPENSSL)
--    set(LUA_OPENSSL_LIBTYPE SHARED)
-+    set(LUA_OPENSSL_LIBTYPE MODULE)
-     if(WIN32)
-         add_definitions(-DLUA_BUILD_AS_DLL)
-         set(EXTRA_LIBS "ws2_32.lib" "crypt32.lib")
-@@ -45,7 +45,7 @@ add_library(lua-openssl ${LUA_OPENSSL_LI
-     src/dsa.c
-     src/ec.c
-     src/engine.c
--    src/mac.c
-+    src/hmac.c
-     src/lbn.c
-     src/lhash.c
-     src/misc.c
-@@ -73,7 +73,7 @@ add_library(lua-openssl ${LUA_OPENSSL_LI
- 
- target_include_directories(lua-openssl PUBLIC
-     ${OPENSSL_INCLUDE_DIR}
--    ${LUA_INCLUDE_DIRS}
-+    ${LUA_INCLUDE_DIR}
-     deps
-     deps/lua-compat/c-api
-     deps/auxiliar
-@@ -81,17 +81,25 @@ target_include_directories(lua-openssl P
- 
- target_link_libraries(lua-openssl PUBLIC
-     ${OPENSSL_LIBRARIES}
--    ${LUA_LIBRARIES}
-     ${EXTRA_LIBS}
-     Threads::Threads
- )
- 
-+if(WIN32)
-+    target_link_libraries(lua-openssl PUBLIC
-+        ${LUA_LIBRARIES}
-+    )
-+endif()
-+
-+if(APPLE)
-+    target_link_options(lua-openssl PUBLIC -bundle -undefined dynamic_lookup)
-+endif()
-+
- target_compile_options(lua-openssl PRIVATE -DLUA_LIB)
- 
- set_target_properties(lua-openssl PROPERTIES
-     PREFIX ""
-     OUTPUT_NAME "openssl"
--    VERSION 0.8.0.0 SOVERSION 0
- )
- 
- install(TARGETS lua-openssl
diff --git a/lang/lua-openssl/patches/020-no-luajit.patch b/lang/lua-openssl/patches/010-no-luajit.patch
similarity index 100%
rename from lang/lua-openssl/patches/020-no-luajit.patch
rename to lang/lua-openssl/patches/010-no-luajit.patch
-- 
2.36.0

